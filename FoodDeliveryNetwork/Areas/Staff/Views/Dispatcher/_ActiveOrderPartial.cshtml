@using FoodDeliveryNetwork.Data.Models;
@using FoodDeliveryNetwork.Web.ViewModels.Dispatcher;

@model SingleActiveOrderViewModel

<div class="card mb-4 w-100">
    <div class="card-body d-flex justify-content-between">
        <div class="w-50">
            <h5 class="card-title">Order ID: @Model.Id</h5>
            <p class="card-text">Customer: @Model.CustomerFirstName @Model.CustomerLastName</p>
            <p class="card-text">Phone: @Model.CustomerPhoneNumber</p>
            <p class="card-text">Address: @Model.Address</p>
            <p class="card-text">Status: @Model.Status</p>
            <p class="card-text">Created On: @Model.CreatedOn</p>
        </div>
        <div class="w-50">
            <ul class="list-group list-group-flush">
                @foreach (var dish in Model.Dishes)
                {
                    <li class="list-group-item d-flex justify-content-between">
                        <span>@dish.DishName</span>
                        <span>@dish.Quantity x</span>
                    </li>
                }
            </ul>
            <p class="mt-3 text-end">Total Price: $@Model.TotalPrice</p>
        </div>
    </div>
    <div class="card-footer d-flex justify-content-end">
        @if (Model.Status == OrderStatus.Pending)
        {
            @using (Html.BeginForm("ChangeOrderStatus", "Dispatcher", FormMethod.Post))
            {
                @Html.Hidden("OrderId", Model.Id)
                @Html.Hidden("NewStatus", OrderStatus.Cooking)

                <button type="submit" class="btn btn-primary me-2">Start Cooking</button>
            }

        }
        else if (Model.Status == OrderStatus.Cooking)
        {
            @using (Html.BeginForm("ChangeOrderStatus", "Dispatcher", FormMethod.Post))
            {
                @Html.Hidden("OrderId", Model.Id)
                @Html.Hidden("NewStatus", OrderStatus.ReadyForPickup)

                <button type="submit" class="btn btn-success me-2">Finish Cooking</button>
            }
        }

        @using (Html.BeginForm("ChangeOrderStatus", "Dispatcher", FormMethod.Post))
        {
            @Html.Hidden("OrderId", Model.Id)
            @Html.Hidden("NewStatus", OrderStatus.CancelledByRestaurant)

            <button type="submit" class="btn btn-danger">Cancel Order</button>
        }
    </div>
</div>


